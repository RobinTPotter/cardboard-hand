<!DOCTYPE html>
<html>
<head>
  <title>ESP/PicoW Sliders</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; text-align: center; }
    .sliders { display: flex; justify-content: center; gap: 40px; margin-top: 20px; }
    .slider-container { display: flex; flex-direction: column; align-items: center; }
    input[type=range] { writing-mode: bt-lr; -webkit-appearance: slider-vertical; width: 30px; height: 200px; }
    input[type=text] { width: 50px; margin: 2px; text-align: center; }
    .val { display: inline-block; width: 40px; text-align: right; }
    .extra-sliders { margin-top: 10px; display: none; }
    .extra-sliders input[type=range] { width: 120px; }
    .switch { margin-top: 20px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>WebSocket Sliders</h1>
  <p>Move sliders to send values (0â€“180) to board.</p>

  <div class="switch">
    <label><input type="checkbox" id="extraToggle"> Show extra sliders</label>
  </div>

  <button id="initBtn">Send Init Values</button>

  <div class="sliders">
    <!-- Repeat slider-container for s1..s5, same structure as before -->
    <!-- For brevity, only s1 shown; copy/paste for s2..s5 changing IDs -->
    <div class="slider-container" id="sc1">
      <input type="range" min="0" max="180" value="90" id="s1">
      <label>Slider 1: <span class="val" id="val1">90</span></label>
      <div>Min: <input type="text" id="s1minTxt" value="0"> Max: <input type="text" id="s1maxTxt" value="180"></div>
      <div class="extra-sliders">
        <label>Min Range <input type="range" min="0" max="1000" value="500" id="s1min"></label><br>
        <label>Max Range <input type="range" min="1000" max="3000" value="2000" id="s1max"></label>
      </div>
    </div>
  </div>

  <script>
    const ws = new WebSocket("ws://" + location.hostname + "/ws");

    // Restore sliders/textboxes from server config
    ws.onmessage = (event) => {
      const msg = event.data;
      if (msg.startsWith("init:")) {
        const data = JSON.parse(msg.slice(5));
        for (let i=1;i<=5;i++){
          const slider = document.getElementById("s"+i);
          const valSpan = document.getElementById("val"+i);
          const minTxt = document.getElementById("s"+i+"minTxt");
          const maxTxt = document.getElementById("s"+i+"maxTxt");

          if(data["s"+i]!==undefined){ slider.value=data["s"+i]; valSpan.innerText=data["s"+i]; }
          if(data["s"+i+"minTxt"]!==undefined){ minTxt.value=data["s"+i+"minTxt"]; slider.min=data["s"+i+"minTxt"]; }
          if(data["s"+i+"maxTxt"]!==undefined){ maxTxt.value=data["s"+i+"maxTxt"]; slider.max=data["s"+i+"maxTxt"]; }
          if(data["s"+i+"min"]!==undefined) document.getElementById("s"+i+"min").value=data["s"+i+"min"];
          if(data["s"+i+"max"]!==undefined) document.getElementById("s"+i+"max").value=data["s"+i+"max"];
        }
      }
    };

    function setupSlider(id,label){ const s=document.getElementById(id); const v=document.getElementById(label);
      s.oninput=()=>{ v.innerText=s.value; ws.send(id+":"+s.value); }; }
    ["s1","s2","s3","s4","s5"].forEach((s,i)=>setupSlider(s,"val"+(i+1)));
    function setupExtra(id){ const s=document.getElementById(id); s.oninput=()=>{ ws.send(id+":"+s.value); }; }
    ["s1min","s1max","s2min","s2max","s3min","s3max","s4min","s4max","s5min","s5max"].forEach(setupExtra);

    document.getElementById("extraToggle").onchange=(e)=>{ document.querySelectorAll(".extra-sliders").forEach(div=>div.style.display=e.target.checked?"block":"none"); };

    for(let i=1;i<=5;i++){ const slider=document.getElementById("s"+i); const minBox=document.getElementById("s"+i+"minTxt"); const maxBox=document.getElementById("s"+i+"maxTxt");
      minBox.onchange=()=>slider

